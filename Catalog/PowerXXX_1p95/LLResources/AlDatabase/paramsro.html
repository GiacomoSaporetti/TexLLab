<!DOCTYPE html>
<html xmlns:t>
<head>
	<title>Status Variables (volatile)</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<script type="text/javascript">
	try
	{ csspath = "file://" + window.external.CatalogPath + "../Common/CSS/" }  // chiede il csspath all'applicazione host
	catch (e)
	{ csspath = document.cookie.slice(8) }  // ricava il csspath dal cookie chiamato 'csspath'

	document.write("<LINK href='" + csspath + "style.css' rel='stylesheet' type='text/css'></link>")
	document.write("<SCRIPT src='" + csspath + "../script/common.js' type='text/javascript'></" + "SCRIPT>")
	document.write("<SCRIPT src='" + csspath + "../script/PLCvars.js' type='text/javascript'></" + "SCRIPT>")

	var app = window.external;
	var m_isModbusCompliantDatabase = app.CallFunction(app.CallFunction("logiclab.get_TargetID") + ".IsModbusCompliantDatabase")
	var m_isArraySupported = m_isModbusCompliantDatabase
	
	function InitPage()
	{
		try
		{
			grid.SetDarkTheme(m_darkTheme);
		}
		catch (err) {}

		// con dark theme vengono usate altre immagini
		let imgPathPrefix = m_darkTheme ? "../img/btn/dark_theme/" : "../img/btn/";

		imgPlus.src = csspath + imgPathPrefix + 'plus.png';
		imgMinus.src = csspath + imgPathPrefix + 'minus.png';
		imgRecalc.src = csspath + imgPathPrefix + 'calculator.png';
		/*imgPlusArray.src = csspath + '../img/plus2.gif'*/
		imgOut.src = csspath + imgPathPrefix + 'arrowOut.png';
		imgIn.src = csspath + imgPathPrefix + 'arrowIn.png';

		var path = _DATAPATH

		/* 	se il database è modbus compliant layout, definizione parametri e validazione cambiano
			Modbus compliant:
			- NO colonna subindex, resa invisibile
			- ogni oggetto occupa Address in base alla sua size calcolata in registri a 16 bit. UINT -> 1 registro, UDINT -> 2 address contigui
			Non Modbus compliant:
			- possibilità di definire sottoindici
			- nessun vincolo indirizzi <-> size parametro
			- NO recalc degli indirizzi (funzionalità utile solo al modbus)
		*/
		if (m_isModbusCompliantDatabase)
			idCmdRecalc.style.visibility  = "visible"
		else
			idCmdRecalc.style.visibility  = "hidden"
		
		SearchError(path)

		FixStyleForGrids();
	}
	
	function OnBeforePrint()
	{
		divPrint.innerHTML = grid.CreateHTMLTable("class='tblPrint'")
	}
	
	function OnAfterPrint()
	{
		divPrint.innerHTML = ""
	}
	</script>

	<script type="text/javascript" src="grid_paramsro.js"></script>
</head>

<body onload="InitGrid(datapath.value)" onunload="OnUnload()" onbeforeprint="OnBeforePrint()" onafterprint="OnAfterPrint()">

<input type="hidden" name=".DATAPATH" id="datapath">

<div class="fill-height-container">
	<div class="TitlePag">
		<span id="pageTitle" class="html5"><t:t>Status Variables (volatile)</t:t></span>
	</div>

	<div class="tableHeader hideOnPrint html5">
		<button class="ll-button" onClick="grid_AddRowXML(true)">
			<img id="imgPlus" alt="Add">
			<span class="label"><t:t>Add</t:t></span>
		</button>

		<button class="ll-button" onClick="grid_DeleteRowXML()">
			<img id="imgMinus" alt="Delete">
			<span class="label"><t:t>Remove</t:t></span>
		</button>

		<button class="ll-button" id="idCmdRecalc" onClick="RecalcAddresses()">
			<img id="imgRecalc" alt="Recalc">
			<span class="label"><t:t>Recalc</t:t></span>
		</button>

		<button class="ll-button" onClick="Assign()">
			<img id="imgIn" alt="Assign">
			<span class="label"><t:t>Assign</t:t></span>
		</button>

		<button class="ll-button" onClick="UnAssign()">
			<img id="imgOut" alt="UnAssign">
			<span class="label"><t:t>UnAssign</t:t></span>
		</button>

		<!--<span id="spanPlusArray" onClick="grid_AddArrayElements(true)">
			<img id="imgPlusArray" alt="Add" src="" class="buttonImg">
			<span class="Titles_table buttonText"><t:t>Add array items</t:t></span>
		</span>-->
	</div>

	<div class="fill-height">
		<object id="grid" classid="clsid:7E61CABD-EB07-425A-9315-B6B2D454BAC1" width="100%" height="100%" border="0" class="hideOnPrint">
			<param name="margin" value="40">
			<param name="multiselect" value="1">
		</object>
		<div id="divPrint" class="hideOnScreen"></div>
	</div>
</div>

<script type="text/javascript" src="grid_params_common.js"></script>
<script type="text/javascript" src="grid_params_events.js"></script>

<script>
	// la funzione verrà eseguita PRIMA della visualizzazione della pagina
	InitPage()
</script>

</body>
</html>
