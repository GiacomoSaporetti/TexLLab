<html>
<head>
	<title>Main page</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
	<script type="text/javascript">
	try
	{ csspath = "file://" + window.external.CatalogPath + "../Common/CSS/" }  // chiede il csspath all'applicazione host
	catch (e)
	{ csspath = document.cookie.slice(8) }  // ricava il csspath dal cookie chiamato 'csspath'

	document.write("<LINK href='" + csspath + "style.css' rel='stylesheet' type='text/css'>")
	document.write("<SCRIPT src='" + csspath + "../script/common.js' type='text/javascript'></" + "SCRIPT>")
	document.write("<SCRIPT src='" + csspath + "../script/LLScanCommon.js' type='text/javascript'></" + "SCRIPT>")

	function InitPage()
	{
		// nome progetto come titolo pagina
		var prj = window.external.GetDocumentPath()
		if (!prj)
			prj = window.external.Translate("Untitled")  //translate
		else
			prj = GetLastPathElement(prj, "\\")
		title.innerText = prj  //translate

		// visualizzazione MRU
		var arr = VBArray(window.external.GetRecentFileList()).toArray()
		for (var i = 0; i < arr.length; i++)
		{
			var anchor = document.createElement("a")
			anchor.innerText = arr[i]
			anchor.href = "#"
			anchor.onclick = function() { window.external.OpenDocumentFile(this.innerText) }
			var item = document.createElement("li")
			item.appendChild(anchor)
			mru.appendChild(item)
		}
	}

	function BrowseRepo()
	{
		var retval = window.external.CallFunction("dllext.ShowBrowseFolderDlg")
		if (retval)
		{
			repo.value = retval
			repo.focus()
			repo.blur()
		}
	}
	
	function InitGrid()   //TODO ?
	{}
	</script>

	<style>
		ul#mru
		{
			font-family: Arial; 
			font-size: 12px;
			color: #000000; 
			margin-left:20px	 
		}
	</style>

    <script type="text/javascript" src="maingrid.js"></script>
</head>

<body onload="SearchError(datapath.value); InitGrid()">

<input type="hidden" name=".DATAPATH" id="datapath">

<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" style="height: 100%">
	<tr class="TitlePag_SysLab">
		<td id="title">Project configuration</td>
	</tr>
<!--
	<tr>
		<td class="SfondoTabSysLab">
			<div class="menu">
			<div class="menu_on" id="tab1" onclick="ChangeTab(1)">
			  <a href="#" onclick="return false">General</a> </div>
			<div class="menu_off" id="tab2" onclick="ChangeTab(2)">
			<a href="#" onclick="return false">Advanced</a>
		</div>
		</div>
	  </td>
	</tr>
-->
	<tr >
	  <td class="SfondoSysLab">
		<!--<div id="page1">
			<table align="center" style="height: 100%">
				<tr style="height: 50">
				  <td>-->
					<fieldset>
					<legend><t:t>Description</t:t></legend>
					<table align="left">
<!--
					  <tr>
						<td nowrap ><label for="repo" class="Textual"><t:t>Repository</t:t>:</label></td>
						<td>
						  <div align="center">
						    <input type="text" id="repo" 
							name=".D(project_config/repository)" 
							 style="width:460px">
				        </div></td>
						<td><button onClick="BrowseRepo()" class="bottone_SysLab" style="width:25px">...</button></td>
					  </tr>
-->
					  <tr>
						<td ><label for="comment" class="Textual"><t:t>Comment</t:t>:</label></td>
						<td><div align="center">
						  <input type="text" id="comment" 
						  name=".D(project_config/datacomment)" 
						    style="width:460px">
					    </div></td>
						<td></td>
					  </tr>
					</table>
					</fieldset>        
					<fieldset>
						<legend><t:t>Recent documents</t:t></legend>
						<ul id="mru"></ul>
					</fieldset>        
		            <p><br>
				        <!--</td>
				</tr>
				<tr>
					<td class="Textual">
						<br>
						All Variables<br>
						<br>
					</td>
				</tr>
				<tr height="100%">
					<td>
						<object id="grid" classid="clsid:21fe38db-ae7a-4f23-8938-49b79835c4de" width="99%" height="99%" border="1">
							<param name="margin" value="50">
							<param name="multiselect" value="1">
						</object>
					</td>
				</tr>
		  </table>
		  </div>
			<div id="page2" style="display:none">
			</div>-->
			            <script type="text/javascript" src="maingrid_events.js"></script> 
        </p>
                    <p>&nbsp;		                            </p></td>
	</tr>
</table>
	
<script>
	InitPage()
</script>

</body>
</html>
